<script>
  // function DumpObject(obj) {
  //   var od = new Object;
  //   var result = "";
  //   var len = 0;
  //
  //   for (var property in obj) {
  //     var value = obj[property];
  //     if (typeof value == 'string')
  //       value = "'" + value + "'";
  //     else if (typeof value == 'object') {
  //       if (value instanceof Array) {
  //         value = "[ " + value + " ]";
  //       } else {
  //         var ood = DumpObject(value);
  //         value = "{ " + ood.dump + " }";
  //       }
  //     }
  //     result += "'" + property + "' : " + value + ", ";
  //     len++;
  //   }
  //   od.dump = result.replace(/, $/, "");
  //   od.len = len;
  //
  //   return od;
  // }
  var globalScannedValue = "";
  // var clickedBtn; var code; Gestisco il keypress sull'input
  function manageScannedKeystrokes(event) {
    // alert("Non credo vada");
    // alert("Ciao: " + DumpObject(event));
    var keycode = (event.keyCode
      ? event.keyCode
      : event.which);
    if (keycode == '13') {
      $("input[name=barcode]").val(globalScannedValue);
      globalScannedValue = "";
      alert("GLOBALSCANNED: " + globalScannedValue);
      $("#send").click();
    } else {
      // Scrivilo nell'input field (accumulando)
      globalScannedValue += keycode; //String.fromCharCode(event.charCode);
    }
  }

  $(document).on("keydown", manageScannedKeystrokes);
  // Se $("#barcode") si becca il focus, elimino il keypress
  $("#barcode").focusin(function () {
    // Blocco il keypress del document
    $(document).off("keydown", manageScannedKeystrokes);
  });
  $("#barcode").focusout(function () {
    // Blocco il keypress del document
    $(document).on("keydown", manageScannedKeystrokes);
  });
</script>
